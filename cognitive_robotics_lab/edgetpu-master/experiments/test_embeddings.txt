python embed.py --experiment_root ~/experiments/my_experiment5 --dataset data/market1501_test.csv --image_root data/image_root --filename market1501_test_embeddings.h5 --batch_size 32
Loading args from /home/user/erem/experiments/my_experiment5/args.json.
Evaluating using the following parameters:
aggregator: None
batch_k: 4
batch_p: 32
batch_size: 32
checkpoint: None
checkpoint_frequency: 1000
crop_augment: None
dataset: data/market1501_test.csv
decay_start_iteration: 15000
detailed_logs: False
embedding_dim: 128
experiment_root: /home/user/erem/experiments/my_experiment5
filename: /home/user/erem/experiments/my_experiment5/market1501_test_embeddings.h5
flip_augment: False
head_name: fc1024
image_root: data/image_root
initial_checkpoint: None
learning_rate: 0.0003
loading_threads: 8
loss: batch_hard
margin: soft
metric: euclidean
model_name: resnet_v1_50
net_input_height: 256
net_input_width: 128
pre_crop_height: 288
pre_crop_width: 144
quiet: False
resume: False
train_iterations: 25000
train_set: data/market1501_train.csv
WARNING:tensorflow:From /home/user/erem/anaconda3/envs/test_env_1/lib/python3.7/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.read_file is deprecated. Please use tf.io.read_file instead.

WARNING:tensorflow:From /home/user/erem/anaconda3/envs/test_env_1/lib/python3.7/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.image.resize_images is deprecated. Please use tf.image.resize instead.

WARNING:tensorflow:From embed.py:194: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/user/erem/folder1/person_re_identification/nets/resnet_utils.py:230: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/user/erem/folder1/person_re_identification/nets/resnet_v1.py:202: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/user/erem/anaconda3/envs/test_env_1/lib/python3.7/site-packages/tensorflow_core/contrib/layers/python/layers/layers.py:1057: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From embed.py:204: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-09-25 10:41:33.539848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-09-25 10:41:33.573345: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.573630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 major: 7 minor: 5 memoryClockRate(GHz): 1.71
pciBusID: 0000:01:00.0
2020-09-25 10:41:33.573801: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-09-25 10:41:33.574477: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-09-25 10:41:33.575105: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-09-25 10:41:33.575267: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-09-25 10:41:33.576055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-09-25 10:41:33.576678: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-09-25 10:41:33.578503: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-09-25 10:41:33.578596: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.578903: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.579196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-09-25 10:41:33.579435: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-09-25 10:41:33.583203: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3600000000 Hz
2020-09-25 10:41:33.583660: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55967bd07cd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-25 10:41:33.583671: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-25 10:41:33.583815: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.584100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 major: 7 minor: 5 memoryClockRate(GHz): 1.71
pciBusID: 0000:01:00.0
2020-09-25 10:41:33.584121: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-09-25 10:41:33.584131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-09-25 10:41:33.584163: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-09-25 10:41:33.584189: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-09-25 10:41:33.584213: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-09-25 10:41:33.584239: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-09-25 10:41:33.584279: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-09-25 10:41:33.584340: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.584718: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.584989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-09-25 10:41:33.585026: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-09-25 10:41:33.637701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-25 10:41:33.637720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-09-25 10:41:33.637724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-09-25 10:41:33.637851: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.638126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.638367: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-25 10:41:33.638591: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-09-25 10:41:33.638610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7467 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080, pci bus id: 0000:01:00.0, compute capability: 7.5)
2020-09-25 10:41:33.639646: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55967d2055d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-25 10:41:33.639655: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080, Compute Capability 7.5
Restoring from checkpoint: /home/user/erem/experiments/my_experiment5/checkpoint-25000
WARNING:tensorflow:From embed.py:212: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-09-25 10:41:34.584548: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-09-25 10:41:34.699553: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-09-25 10:41:35.712664: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 3.79G (4070696448 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
Embedded batch 19712-19732/19732
Done with embedding, aggregating augmentations...

